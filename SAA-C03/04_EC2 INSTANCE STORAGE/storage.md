# EBS

인스턴스가 실행 중인 동안 연결 가능한 네트워크 다리으브입니다. 인스턴스가 종료된 후에도 데이터를 자속 가능합니다.
EBS 볼륨을 생성할 때는 특정 가용 영역에서만 가능합니다. EBS 볼륨이란 네트워크 USB 스틱이며 네트워크를 통해 연결됩니다.
EBS 볼륨은 네트워크 드라이브며 물리적 드라이브가 아닙니다. EC2 인스턴스에서 분리되며 빠ㅣ르게 다른 인스턴스로 연결 됩니다. 
스냅샷을 이용하면 다른 가용 영역으로도 볼륨을 옮길 수 있습니다. 
또한 볼륨이기에 용량을 미리 결정해야 합니다. 프로비전 용량에 따라 요금이 청구됩니다. 

인스턴스 하나에 두개의 EBS 볼륨이 연결되는 건 문제없이 가능합니다. 필요한 경우만 연결이 가능한 강력한 기능입니다.
EC2 인스턴스를 통해 EBS 볼륨을 생성하는 경우 종료 시 삭제라는 속성이 있습니다.
*기본 설정으로는 루트 볼륨에 체크되어 있고 새로운 EBS 볼륨에는 체크가 되어 있지 않습니다. 삭제 기능의 활성화 여부는 조작이 가능합니다.*\

- 볼륨 생성

  ![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/adcff139-5120-4366-899d-177539557dc7)

# EBS 스탭샷

EBS 스냅샷은 EBS 볼륨의 특정 시점에 대한 백업입니다. EBS 스냅샷은 다른 가용 영역이나 다른 리전에도 복사할 수 있습니다. 

EBS 스냅샷 아카이브는 최대 75% 까지 저렴한 아카이브 티어로 스냅샷을 옮길 수 있는 기능입니다. 스냅샷을 아카이브 티어로 옮기면 아카이브를 복원하는데 24 ~ 72 시간이 걸립니다. 즉 즉시 복원되지 않습니다.

EBS 스냅샷 휴지통은 스냅샷을 삭제하는 경우 영구 삭제가 아닙니다. 복원 가능하며 1일에서 1년 사이로 보관 설정 가능합니다.

마지막 기능은 빠른 스냅샷 복원(FSR) 입니다. 스냅샷을 완전 초기화해 첫 사용에서의 지연 시간을 없애는 기능입니다. 스냅샷이 아주 크고 EBS 볼륨 또는 EC2 인스턴스를 빠르게 초기화해야 할 때 유용합니다. 하지만 비용이 많이 듭니다. 


# AMI

EC2 인스턴스를 통해 만든 이미지를 통징합니다. 
원하는 소프트웨어 또는 설정 파일을 추가하거나 별도의 운영 체제를 설치할 수도 있고 모니터링 툴을 추가 가능합니다. 
AMI를 따로 구성하면, 부팅 및 설정에 드는 시간을 줄이며 AMI를 특정 지역에 구축한 다음 다른 지역으로 복사해서 AWS의 글로벌인프라를 활용 가능합니다. 

# EC2 인스턴스 스토어
EC2 인스턴스는 가상 머신이지만 실제로는 하드웨어 서버에 연결되어 있습니다. 같은 서버에서 해당 서버에 물리적으로 연결된 디스크 공간을 갖습니다. 특정 유형의 EC2 인스턴스는 EC2 인스턴스 스토어라고 불리며 이는 해당하는 물리적 서버에 연결된 하드웨어 드라이브를 가리킵니다. I/O 성능 향상을 위해 활용됩니다. 

훌륭한 처리량을 갖추고 있기에 매우 향상된 디스크 성능을 요할 때에 활용가능합니다. 하지만 인스턴스 또는 인스턴스 스토어를 중지 또는 종료하면 해당 스토리지 또한 손실되기에 버퍼나 캐시 스크래치 데이터 또는 임시 콘텐츠를 사용하려는 경우 좋은 장소가 되지만장기적은 스토리지에는 EBS가 적합합니다.

# EBS VOLUME

gp2/gp3 는 범용 ssd 볼륨으로 다양한 워크로드에 대해 가격과 성능의 절충안입니다.

io21/io2 는 최고의 성능을 자랑하는 ssd 볼륨으로 미션 크리티컬이자 지연 시간이 낮고 대용량의 워크로드에 적합합니다. 

st1 는 저비용의 hdd볼륨으로 잦은 접근과 처리량이 많은 워크로드에 적합합니다. 

*시험에 있어서는 범용 gp2 와 IOPS 프로비저닝이 가장 중요한 내용으로 출제 됩니다.*
gp2는 짧은 지연 시간을 자랑하며 효울적인 비용의 스토리지 입니다. 가상테스크톱, 개발 ,테스트 환경에서 사용 가능합니다. 
gp3는 최신 세대의 볼륨으로 기본 성능으로 3000iops 초당 125mb 처리량을 제공합니다. 최대 16000iops, 1000mb 까지 가능합니다. 

gp2는 오래된 버전으로 최대 3000iops 볼륨과 iops가 연결되어 있어서 iops가 증가할 때면 즉, 볼륨의 GB 수를 늘릴 때에 새 배 더 증가한 16000iops 가 된다는 의미입니다. 

gp2/gp3는 비용 효과적인 스토리지이며 gp3에서는 iops 와 처리량을 독자적으로 설정 할수 있는 반면 gp2에서는 그 둘이 연결되어 있다는 것입니다. 

스토리지 성능과 일관성에 아주 민감한 경우 프로비저닝된 iops 와 스토리지 크기를 독자적으로 증가 시킬수 있도록 gp2/gp3 볼륨에서 io1/io2 볼륨으로 바꾸는 것이 해답이 됩니다. 즉 일반적으로 데이터베이스 워크로드에 알맞는 경우는 다음과 같습니다. 

io2 는 io1 보다 동일한 비용으로 내구성과 기가 당 iops의 수가 더 높습니다. 32000 iops이상을 요할 때에는 EC2 Nitro 가 필요합니다.

st1/sc1 는 EBS 다중 연결을 지원하는 프로비저닝 iops의 EBS 볼륨 유형입니다. 
st1은 처리량 최적화 HDD로 빅 데이터나 데이터 웨어하우징 로그 처리에 적합합니다. 

sc1는 콜드 HDD가 있는데 이는 아카이브 데이터용으로 접근빈도가 낮은 데이터에 적합합니다. 최저 비용으로 데이터를 저장할 때에 사용합니다. 

# EBS 볼륨의 다중 연결 기능

해당 가용영역에서 여러 EC2 인스턴스에 하나의 EBS 볼륨을 연결 가능하며 io1/io2 제품군에서만 가능합니다. 동시에 읽고 쓰기가 가능합니다. 16개의 인스턴스만 같은 볼륨에 연결 가능합니다. 

# EBS 볼륨 암호화

저장 데이터가 볼륨 내부에 암호화 되고 은스턴스와 볼륨간의 전송 데이터 역시 암호화 됩니다. 스냅샷도 예외는 아닙니다. 암호화를 사용하는 이유는 지연 시간에는 영향이 거의 없고  kms에서 암호화 키를 생성해 aes-256 암호화 표준을 갖습니다. 

볼륨을 action copy snapshot 으로 스탭샷을 복사할때 암호화 가능합니다. 즉 비암호화 스냅샷으로부터 암호화된 스냅샷을 만들고 create volume from snaphot 을 실행하여 암호화된 EBS 볼륨을 만든다. 

# EFS

EC2 인스턴스는 서로 다른 가용성 영역에 있을 수 있습니다. 가용성이 높고 확장성이 뛰어나며 비쌉니다. 사용량에 다라 비용을 지물하므로 미리 용량을 프로비저닝할 필요가 없습니다. 사용 사례로는 콘텐츠 관리, 웹서방, 데이터 공유, WordPress 입니다.  

EFS에 대한 액세스를 제어하려면 보안 그룹을 설정해야 합니다. 윈도우가 아닌 Linux 기반 AMI 와만 호환이 가능합니다. KMS를 통해 EFS 드라이브에서 미사용 암호화를 활성화 할 수 있습니다. 따라서 Posix 시스템을 이용합니다. 표준 파일 API도 있습니다. 

- efs 성능

EFS 스케일링은 동시 NFS 클라이언트 수천 개와 10GB 이상의 처리량을 확보가능합니다. PB 규모의 네트워크 파일 세스템으로 자동 확장 가능합니다.
네트워크 파일 스세템 생성시 성능 모드를 설정 가능합니다.

범용 모드는 지연시간에 민감한 사용 사례에 사용됩니다. 웹서버나 cms 입니다.

처리량을 최대화 하려면 최대 i/o 모드를 선택합니다. 지연 시간이 더 긴 네트워크 파일 시스템이지만 처리량과 병렬성이 높습니다. 빅데이터 애플리케이션이나 미디어 처리가 필요한 경우 유용합니다.

스토리지 크기에 관계없이 처리량을 설정하고 싶은 경우에는 프로비저닝을 이용합니다. 

엘라스틱 옵션은 워크로드에 따라 처리량을 자동으로 조절 가능합니다. 즉 워크로드를 예측하기 어려울 때 유용합니다. 

- 스토리지 클래스

표준 계층은 자주 액세스하는 파일을 위한 계층이고, 자주 액세스 하지 않는 계층은 EFS-IA입니다. 또한 수명 주기 정책을 사용해야 합니다. 

가용성과 내구성 측면에서는 두가지 옵션이 있습니다.
표준은 다중 AZ 로 EFS를 설정가능합니다. 프로덕션 사용 사례에 적합합니다. 
개발용으로는One Zone EFS 파일시스템은 개발에는 좋지만 하나의 AZ에만 있고 백업은 기본적으로 활성화되도록 설정되어 있으며 액세스 빈도가 낲은 스토리지 계층과 호환됩니다. OneZone AI라고 불리며 약 90% 할인을 받을 수 있습니다. 

# EBS vs EFS

ebs 볼륨은 한번에 하나의 인스턴스에 첨부됩니다. io1/io2 유형 볼륨의 다중 첨부 기능을 제외입니다. ebs 볼륨돟 az 수준에 잠깁니다. 때문에 스냅샷을 만들어야 합니다. 

efs는 하나의 파일 시스템으로 서로 다른 az에서 서로 다른 마운트 대상을 가지며 여러 인스턴스가 하나의 파일 시스템을 공유합니다. efs는 ebs보다 가격대가 높지만 EFS-IA 기능을 활용하여 비용 절감을 합니다. 



