# Scalability & High Availability
- 확장성은 수직 확장성과 탄력성이라고 불리는 수평 확장성이 있습니다.
- 수직 확장성은 db와 같이 분산되지 않은 시스템에서 흔히사용됩니다.
  - rds, elasticcache 에서 확인 가능합니다.
- 고가용성의 목표는 데이터 센터에서의 손실에서 살아남는 것으로
  - 수동형 고가용성은 rds 가 다중 az 를 확보한 상태입니다.
  - 고가용성은 동일 애플리케이션의 동일 인스턴스를 다의 AZ에 걸쳐 실행하는 경우를 의미
- 확장성은 lb 와 scale out/in 이 있습니다. 

# ELB 
- 트래픽을 백엔드나 다운스트림 EC2 인스턴스 또는 서버들로 전달하는 역할을 합니다
- 부하를 다수의 다운스트림 인스턴스로 분산하기 위해서죠
- 웹 사이트에 암호화된 HTTPS 트래픽을 가질 수 있죠
- 쿠키로 고정도를 강화할 수 있고 영역에 걸친 고가용성을 가지며
- 클라우드 내에서 개인 트래픽과 공공 트래픽을 분리할 수 있습니다
- AWS가 업그레이드와 유지 관리 및 고가용성을 책임지며
- EC2 인스턴스와도 물론 통합이 가능하며 나중에 배우겠지만 스케일링 그룹
- Amazon ECS와 인증서 관리(ACM) CloudWatch, Route 53, WAF Global Accelerator 등 앞으로 더 늘어날 겁니다
- 포트 80에서 HTTP 트래픽을 허용하며 소스는 IP 범위가 아니라 보안 그룹이 되죠
- 2016년에 출시된 애플리케이션 로드 밸런서인 ALB입니다
  - HTTP, HTTPS와 WebSocket 프로토콜을 지원하죠
- 2017년에 새로 출시된 네트워크 로드 밸런서도 있는데
  - TCP, TLS, secure TCP와 UDP 프로토콜을 지원하죠
- 그리고 2020년에 나온 게이트웨이 로드 밸런서도 있습니다
  - GWLB라고 불리며 네트워크층에서 작동하므로
  - 3계층과 IP 프로토콜에서 작동하는 거죠

# ALB
- 7계층, 즉 HTTP 전용 로드 밸런서로 머신 간 다수 HTTP 애플리케이션의 라우팅에 사용이 되죠
- 예를 들면, URL 대상 경로에 기반한 라우팅이 가능합니다
- 마이크로 서비스나 컨테이너 기반 애플리케이션에 가장 좋은 로드 밸런서로
- ECS 인스턴스의 동적 포트로의 리다이렉션을 가능하게 해주거든요
- 쿼리 문자열이나 매개변수 라우팅을 사용하면 됩니다

# NLB
- 네트워크 로드 밸런서는 굉장히 고성능이라는 겁니다
- NLB의 다른 특징은, 가용 영역 당 하나의 고정 IP만 있다는 점입니다
  - 그리고 각 가용 영역에 탄력적 IP를 배정할 수 있죠
- 만약 시험에 애플리케이션이 1개, 혹은 서로 다른 2개, 3개의 IP로만 액세스 가능하다고 나오면 네트워크 로드 밸런서를 옵션으로 떠올릴 수 있어야 해요
- 즉 NLB가 EC2 인스턴스로 리디렉션할 수 있고, TCP와 UDP 트래픽을 그쪽으로 보낼 수있다는 거죠
  - 프라이빗 IP 주소여야 합니다
- 가령 NLB 덕분에 고정 IP 주소를 얻을 수 있고 ALB 덕분에 HTTP 트래픽을 처리하는 것과 관련한 모든 규칙을 얻을 수 있죠
- NLB의 대상 그룹이 하는 상태 확인은 세 가지 프로토콜을 지원한다는 겁니다
  - TCP 프로토콜, HTTP 프로토콜, HTTPS 프로토콜입니다

 # GWLB
 - GWLB는 배포 및 확장과 AWS의 타사 네트워크 가상 어플라이언스의 플릿 관리에 사용됩니다
 - 모든 트래픽이 방화벽을 통과하게 하거나 침입 탐지 및 방지 시스템에 사용합니다
 - 6081번 포트의 GENEVE 프로토콜을 사용하세요 바로 GWLB가 됩니다

  # Sticky Sessions (고정 세션), elb 설정 
  - 즉, 쿠키가 만료되면 클라이언트가 다른 EC2 인스턴스로 리디렉션 된다는 것입니다
  - 애플리케이션 기반 쿠키는 대상으로 생성된 사용자 정의 쿠키로 애플리케이션에서 생성됩니다
  - 두 번째 유형은 기간 기반 쿠키입니다 

# Cross-zone Load Balancing 
- ![image](https://github.com/user-attachments/assets/593b6a91-81c3-4c15-b291-f0f977d95ce7)
- 교차 영역 밸런싱은 트래픽을 모든 EC2 인스턴스로 균등하게 분산합니다,
- 애플리케이션 로드 밸런서의 경우 교차 영역 로드 밸런싱이 기본적으로 활성화돼 있기 때문에

# SSL/TLS 
- SSL 인증서는 클라이언트와 로드 밸런서 사이에서 트래픽이 전송되는 동안 암호화되도록 해줍니다
- SNI는 무척 중요한 문제를 해결하는데요, 바로 하나의 웹 서버에 여러 SSL 인증서를 로드해 웹 서버가 여러 웹사이트를 지원하게 만드는 방법이죠
- 최신 세대인 ALB와 NLB를 활용할 때만 적용되고요 혹은 CloudFront에서 적용됩니다.
- 서버 이름 표시, 즉 SNI를 사용하면 다른 SSL 인증서를 사용하는 서로 다른 웹사이트를 위한 여러 대상 그룹을 가질 수 있습니다

# Connection draining
- 애플리케이션 밸런서나 네트워크 로드 밸런서를 사용하는 경우에는 등록 취소 지연이라고 부릅니다
- ELB는 등록 취소 중인 EC2 인스턴스로 새로운 요청을 보내지 않는 거죠 -> 다른 ec2 인스턴스에 elb 에 의해 연결
  - 해당 ec2 는 드래이닝 상태

# ASG
- 오토 스케일링 그룹은 무료이며, 그 아래에 생성되는 EC2 인스턴스와 같은 리소스에 대해서만 비용을 내면 됩니다
- 이제 ASG를 생성하기 위한 속성 면에서, 시작 템플릿을 만들어야 합니다
- CloudWatch 경보를 기반을 ASG에서 스케일 인, 스케일 아웃을 할 수 있는데요

# ASG Scaling Policy
- 동적 스케일링
  - CPU 사용률과 같은 ASG에 대한 메트릭을 정의하고 40%와 같은 목표 값을 정의하는 것입니다, CloudWatch
- 예측 스케일링 (Scheduled Scaling)
  - ASG는 자동으로 과거 부하를 분석한 다음 예측치를 생성하여 예측치를 기반으로 스케일링 작업을 예약합니다
- 스케일링 쿨다운
  - 그리고 그 쿨다운 시간 동안 ASG는 추가 인스턴스를 개시하거나 종료하지 않습니다

- cpu 활용도 및 네트워크 사용량 (고유 메트릭, 클라우드 워치 기반 사용자 정의 메트릭)

# ASG Instance Refresh 

- 인스턴스를 종료한 다음 다시 나타날 때까지 기다리는 대신, 오토 스케일링 그룹의 고유 기능인 인스턴스 새로 고침을 사용할 수 있습니다
- 이를 통해 시간이 지나면서 삭제되는 인스턴스의 개수를 오토 스케일링 그룹에게 알려 줍니다 인스턴스가 종료되면 새 인스턴스가 새 시작 템플릿으로 나타나게 되는데요



















