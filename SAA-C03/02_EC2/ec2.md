# AWS 예산

- IAM USER 결제 액세스

  ![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/7d8af16e-6228-4602-bc84-c5eb20b58c14)

- 서비스별 요금

  ![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/f77b5531-f851-435d-bca0-ab9cc3225273)

- AWS 예산 알림 설정

  ![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/230bdc73-0c4f-434b-8317-3b913695f3f2)

# AWS EC2

EC2 사용자 데이터 스크립트는 루트 계정에서 실행됩니다.

sudo 명령어를 사용합니다 

사용자 데이터는 스크립트로 EC2 인스턴스를 처음 생성할 때만 실행됩니다. 

- 인스턴스 유형

  ![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/2a40e1b5-4f04-4c06-a9da-2fcaa70de2d7)

- key pair 생성

  ![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/3a30cd24-a68d-4af7-add8-cee7437ad25a)

- 스토리지 세부 정보

  ![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/33b6a8d2-6dc9-4454-b2a1-eef634faf438)

공용 IPv4 는 인스턴스의 재실행 후 변하게 되지만 사설 IPv4는 변하지 않는다. 

# EC2 인스턴스 유형 

- 범용 인스턴스는 웹 서버나 코드 저장소와 같은 다양한 작업에 적합하니다. 컴퓨팅, 메모리, 네트워킹 간의 군형도 잘 맞습니다.

- 컴퓨팅 최적화 인스턴스는 컴퓨터 집약적인 작업에 최적화된 인스턴스입니다. 고성능 프로세서는 일부데이터의 일괄처리에 사용하거나 미디어 트랜스코딩 작업시 혹은 고성능 웹서버가 필요하거나 고성능 컴퓨팅이라는 HPC 작업을 할때 그리고 머신 러닝이나 전용 게임 서버가 있을 때 사용합니다. 

- 메모리 최적화 인스턴스는 메모리에서 대규모 데이터셋을 처리하는 유형의 작업에 빠른 성능을 제공하며 RAM을 뜻하고 사용사례는 대부분 인 메모리 데이터베이스가 되는 고성능의 관계형 또는 비관계형의 데이터베이스에 사용하고 분산 웹스케일 캐시 저장소에도 사용합니다.

  또는 비지니스 인텔리전스 즉, BI에 최적화된 인 메모리 데이터베이스와 대규모 비정형 데이터의 실시간 처리를 실행하는 애플리케이션에도 사용합니다. 

- 스토리지 최적화 인스턴스는 로컬 스토리지에서 대규모의 데이터셋에 액세스할 대 적합한 인스턴스입니다. 고주파 온라인 트랜잭션 처리인 OLTP시스템에 사용되며 관계형 비관계형인 NOSQL 데이터베이스에 사용합니다. 데이터베이스 섹션에서는 레디스와 같은 메모리 데이터베이스의 캐시나 데이터 웨어하우징 애플리케이션과 분산 파일 시스템에 사용됩니다. 

# EC2 보안 그룹

- 여러 인스턴스에 연결할 수 있으며 보안그룹과 인스턴스간의 일대일 관계는 없다.보안 그룹은 지역과 VPC 결합으로 통제되어 있습니다. 그래서 지역을 전환하면 새 보안그룹을 생성하거나 다른 VPC를 생성해야 합니다. 보안그룹은 EC2 외부에 있습니다. 그래서 트래픽이 차단되면 EC2 인스턴스를 확인할 수 없죠 SSH 액세스를 위해 하나의 별도 보안 그룹을 유지하는 것이 좋습니다.

- SSH는 시큐어 셸이라는 의미로 포트는 22번 포트로 EC2 인스턴스로 로그안하도록 합니다. 파일전송 프로토콜일 FTP의 포트는 21번 포트이며 파일 공유 시스템에 파일을 업로드 하는데 사용됩니다. SFTP도 22번 포트를 사용하는 이유는 SSH를 사용해서 업로드하기에 보안 파일 전송 프로토콜이 되기 때문입니다. 원격 데스크톱 프로토콜인 RDP는 3389번 포트이며 원도우 인스턴스에 로그인할 때 사용됩니다. 따라서 22번 포트는 LINUX 인스턴스용이고 3389번 포트는 윈도우 인스턴스용 RDP입니다.

- SSH를 시도했을 때 타임아웃이 되거나 혹은 HTTP쿼리를 시도하는데 타임아웃이 되면 그건 100% EC2 보안그룹 때문입니다.

- 아웃바운드 규칙에서의 모든 트래픽 유형은 모든 곳에 대한 완전한 인터넷 연결성이 갖게 됩니다. 

# SSH
SSH 는 명령줄 인터페이스 도구로 Windows10이상 버전에서만 사용 가능합니다. EC2 Instance Connect 와는 다른 개념이다. 

- EC2 인스턴스로 SSH

  ![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/a5d3968c-50cb-4b71-a701-0dad8c4ffaab)

- EC2 Instance Connect

  ![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/ffe7f2c8-884f-479a-83b2-c509469d8703)

 - EC2 인스턴스 IAM 역할

    ![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/47795d25-040b-4ae6-8f70-21da201f6ed6)

# EC2 Instance 

- 온디맨드 인스턴스는 여러분이 사용한 대로 지불하게 됩니다. Linux, Windows 를 사용한다면 1분 이후에 초단위로 청구가 이루어지며 나머지는 1시간 단위로 청구가 됩니다. 비용이 가장 많이 들지만 바로 지불할 금액은 없습니다. 장기적인 약정도 없습니다. 단기적이고 중단 없는 워크로드가 필요할 대, 또는 애플리케이션의 거동을 예측할 수 없을 때 추천합니다.
  
- 예약 인스턴스는 온디맨드에 비해 72% 할인은 제공하며 특정한 인스턴스 속성을 예약합니다. 예약 기간을 1년에서 3년으로 지정하여 선결제를 하게되면 최대 할인을 받을 수 있습니다. 범위를 기준으로 특정한 리전이나 존으로 할 수 있습니다. 즉 특정한 az에 있는 예약된 용량을 의미합니다.

- 전환형 인스턴스는 인스턴스 타입, 인스턴스 패밀리, 운영체계, 범위, 테넌시를 변경할 수 있습니다.
  
- 절약 플랜은 장기간 사용하면 할인을 받습니다. 70% 할일은 받으며 사용량이 한도를 넘어서면 적약 플랜은 온디맨드 가격으로 청구를 하게 됩니다.

- 스팟 인스턴스는 aws에서 가장 비용효율적인 인스턴스입니다. 인스턴스가 고장에 대한 회복력이 있다면 유용합니다. 시작 시간과 종료 시간이 유연한 워크로드가 있습니다. 데이터베이스는 적절하지 않고요

- 전용 호스트는 ec2인스턴스 용량이 있는 실제 물리적 서버를 받게 되고요, 법규 준수 요건이 있는 활용사례나 소켓, 코어, vm소프트웨어 라이선스를 기준으로 청구되는 기존의 서버에 연결된 소프트웨어 라이선스가 있는 경우가 있을 수 있습니다. 온디맨드로 초당 비용을 지불하거나 1년 또는 3년 동안 예약가능합니다.

- 전용 인스턴스는 여러분의 전용 하드웨어에서 실행되는 인스턴스 입니다. 물리적 서버와는 다르며 여러분은 같은 계정에서 다른 인스턴스와 함께 하드웨어를 공유할 수 있습니다. 하지만 인스턴스 배치에 대한 통제권이 없습니다. 여러분이 자신만의 인스턴스를 자신만의 하드웨어에 갖는다는 것인 반면에, 전용 호스트는 여러분이 물리적 서버 자체에 대한 접근권을 갖고 낮은 수준의 하드웨어에 대한 가시성을 제공해 준다는 점입니다.

- EC2 용량 예약은 원하는 기간동안 특정한 AZ에서 온디맨드 인스턴스를 예약 가능합니다. 그리고 필요할 때마다 그 용량에 접근할 수 있죠 기간약정은 없고요, 그래서 언제라도 용량을 예약하고 취소할 수 있습니다. 특정한 AZ에 있어야하는 단기적이고 중단 없는 워크로드에 아주 적합합니다.

- 예시
  ![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/f1e0a17c-268b-438d-8768-0cd7458fb587)


# 스팟 인스턴스

온드맨드에 비해 90%까지 할인을 받을 수 있습니다. 

스팟 블록은 지정된 기간 동안 스팟 인스턴스를 차단하는 겁니다. 1~6시간까지 가능하며 그동안 중단 없이 해당 블록을 사용할 수있다고 규정되어 있어요 그렇게 되면 AWS가 스팟 인스턴스를 회수하지 않죠 배치 작업 및 데이터 분석, 장애 복원력 이 뛰어난 워크로드 등에 사용합니다. 

스팟 인스턴스를 종료하는 법을 알아보자면, 스팟 요청에 대해 이해해야 합니다. 스팟 요청에서는 원하는 인스턴스수 , 최대 가격 및 시작 사양 등을 정의합니다. 요청에는 두가지 유형이 있습니다 스팟 인스턴스 일회성 요청을 하거나, 영구 인스턴스 요청을 할 수 있습니다. 일회성 요청인 경우, 스팟 요청이 완료되는 즉시 인스턴스가 시작되며 영구 요청 유형인 경우 스팟 요청이 유효한 기간 동안은 이 인스턴스 수도 유효하다는 뜻이죠 즉, 인스턴스가 어떤 이유로든 중지되거나, 스팟 가격을 기준으로 중단되는 경우 스팟 요청이 다시 실행되고, 유효성이 확인되면, 스팟 인스턴스가 다시 시작되는 겁니다.  

스팟 요청은 여전히 활성 상태라면 자동으로 중지한 인스턴스를 실행합니다. 스팟요청을 취소하려면, 스팟 요청이 열려있는 상태 즉 활성 상태이거나, 비활성화 상태여야 합니다.
따라서 스팟 인스턴스를 완전히 종료하고 다시 시작하지 않으려면 먼저 스팟 요청을 취소하고, 그다음에 관련 스팟 인스턴스를 종료해야 합니다. 

스팟플릿은 비용절감하는 궁극적인 방법입니다. 여러분이 정의한 가격 제한으로 목표 용량을 충족하기 위해 최선을 다합니다. 가능한 런치 풀에서 시작하며 다양한 가용성 영역을 가질 수 있습니다. 스팟 플릿이 예산에 도달하거나 원하는 용량에 도달하면 인스턴스 시작을 중지합니다. 가격 용량 최적회는 먼저 사용 가능한 용량이 가장 큰 풀을 선택하고 그중 가격이 가장 낮은 풀을 선택합니다. 여러개의 런치 풀과 여러 인스턴스 유형을 정의할 수 있습니다. 원시 전력만 신경 쓰면 되죠 따라서, 스팟 플릿을 요청하는 경우는 조건을 만족하는 모든 인스턴스 유형과 모든 AZ를 선택하라는 겁니다. 
