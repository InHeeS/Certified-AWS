#CIDR D- IPV4

클래스 없는 도메인 간 라우팅을 살펴봅시다. 

먼저 기본 IP란 범위에 포함된 IP예요
일반적으로는 범위의 시작이 되는데
범위 내부에 있기도 합니다
예시로 10.0.0.0 또는 192.168.0.0 등이 있어요

다른 요소는 서브넷 마스크입니다
IP에서 변경 가능한 비트의 개수를 정의합니다

EX) IP 주소/32는
2의 0승으로 IP 하나만 허용합니다
그게 왼편에 있는 IP죠

IP 주소/31이라면
두 가지 IP가 허용됩니다
192.168.0.0과 192.168.0.1 말이에요

동일한 IP 주소/30의 경우
기하급수적으로 증가하는데 IP 네 개가 허용됩니다

건너뛰어서 /16으로 가면
2의 16승 개 IP가 바뀌니까 65,536개가 됩니다

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/2364fad0-74f5-4b53-a594-d66ea14ec889)

즉 IANA에서 구축한 특정 IPv4 주소 블록은
사설 LAN 네트워크 다시 말해 로컬 네트워크나

공용 인터넷 주소입니다
사설 IP는 특정 값만 허용합니다

# Default VPC Walkthrough

# vpc in aws - ipv4

단일 AWS 리전에 여러 VPC를 둘 수 있습니다
리전당 최대 5개까지 가능한데
엄격히 제한하지 않아서 여러분이 늘릴 수 있어요

VPC마다 할당된 CIDR는 다섯 개입니다
각 CIDR의 최소 크기는 /28로
IP 주소는 최소 16개가 있고요
최대 크기는 /16으로 IP 주소는 최대 65,536개입니다

VPC가 사설 리소스이기 때문에
사설 IPv4 범위만 허용됩니다

IPv4 CIDR를 추가할 수 있다는 점도 중요해요

# Adding Subnets

서브넷이란
VPC 내부에 있는 IPv4 주소의 부분 범위입니다

이 범위 내에서
AWS가 IP 주소 다섯 개를 예약합니다
IP 주소 처음 네 개, 마지막 한 개를 서브넷마다 예약해요

예를 들어 CIDR 블록 10.0.0.0/24가 있다면
일부는 예약된 IP 주소입니다
첫 번째는 네트워크 주소예요

AWS는 두 번째 .1을 VPC 라우터용으로 예약하고
10.0.0.2를 Amazon 제공 DNS에 매핑합니다
아주 중요한 부분이에요 .3은 당장 사용되진 않지만
나중에 필요할지 모르니까 예약해 두고요

네트워크 브로드캐스트 주소인 .255도 있는데
AWS는 VPC에서 브로드캐스트를 지원하지 않기에
예약은 되지만 사용하는 건 안 됩니다

EC2 인스턴스 서브넷에서 IP 주소 29개가 필요할 때
/27 서브넷은 사용 못 한다는 걸 시험 볼 때 기억해 두세요
/27 IP 주소는 32개인데
예약된 IP 주소 다섯 개를 제외하면
27개만 남기 때문입니다

29개가 필요하댔는데 그보다 작잖아요
따라서 서브넷 크기는 /26이어야 합니다

# 서브넷에 인터넷 액세스를 연결(igw)

인터넷 Gateway는 VPC의 리소스를
인터넷에 연결하도록 허용하는
EC2 인스턴스나 람다 함수 등입니다

VPC와는 별개로 생성해야 하고
VPC는 인터넷 Gateway 하나에만 연결되며
반대의 경우도 마찬가지입니다 인터넷 Gateway 자체는
인터넷 액세스를 허용하지 않습니다

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/1963e879-65fa-4188-9850-acd3abb83299)

따라서 인터넷 GateWay가 인터네소가 연결 가능합니다. 

퍼블릭 IPv4 주소가 있어도 인터넷에는 연결되어 있지 않습니다
이제 인터넷 게이트웨이가 필요한 타이밍이죠

인터넷 게이트웨이가 있어도 경로를 지정해 줘야 합니다
즉 라우팅 테이블을 수정해야 해요

현재 기본 라우팅 테이블은
서브넷 네 개와 연결되는데 이러한 방법보다는
명시적 서브넷 연결이 훨씬 좋은 방법입니다

이렇게 해야 서브넷을 올바른 라우팅 테이블에 할당할 수 있어요

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/93d3f432-f985-4c3e-b0ce-1a3fe70d56a7)


만약 이게 CIDR의 로컬 IP라면
경로도 로컬이 되어야 합니다
하지만 퍼블릭 IP를 포함한 다른 IP인 경우
대상은 인터넷 게이트웨이가 됩니다

# bastion Hosts 

사용자가 프라이빗 서브넷에 없는 EC2 인스턴스에 액세스하고자 합니다
사용자인 우리는 퍼블릭 인터넷에 있는데
이는 사용자의 EC2 인스턴스가 프라이빗 서브넷에 위치하지 않기 때문이죠

프라이빗 서브넷에 대한 인터넷 액세스는 없습니다

이때 퍼블릭 서브넷에 있는 EC2 인스턴스 즉 배스천 호스트로
프라이빗 서브넷에 있는 EC2 인스턴스에 액세스할 수 있습니다

*시험에는 보안 규칙 관련 내용도 출제되는데
무엇을 정의할 수 있는지 잘 이해하셔야 합니다
배스천 호스트를 위해서는 보안 그룹이 반드시 인터넷 액세스를 허용해야 합니다
하지만 모든 인터넷 액세스를 허용하면
보안상 위험이 크기 때문에
가령 기업의 퍼블릭 CIDR 액세스만 허용하거나 사용자의 인터넷 액세스만 허용하는 등
이를 제한하는 게 좋겠죠
이렇게 배스천 호스트의 EC2 보안 그룹을 최대한 제한하여
특정 IP만 액세스가 가능하도록 설정할 수 있습니다*

프라이빗 서브넷의 EC2 인스턴스 보안 그룹에서는
반드시 SSH 액세스를 허용해야 합니다
따라서 포트 22번이 배스천 호스트의 프라이빗 IP가 되거나
배스천 호스트의 보안 그룹이 되는 셈이죠

# nat instance 

네크워크 주소 변환을 뜻하면서 사설 서브넷 ec2 인스턴스가 인터넷에 연결되도록 허용합니다. 

공용 서브넷에서 실행되어야 하고 공용 및 사설 서브넷을 연결합니다. 

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/398bf1cd-09d0-4d0a-893d-4455730cec53)


또 NAT 인스턴스를 위해 소스 및 목적지 확인 설정을
EC2 인스턴스에서 비활성화해야 하는 겁니다

그리고 라우팅 테이블을 통해
사설 인스턴스가 NAT 인스턴스에서
인터넷 Gateway까지 통신하도록 합니다


NAT 인스턴스는 가용성이 높지 않고
초기화 설정으로 복원할 수 없어서
여러 AZ에 ASG를 생성해야 하고
복원되는 사용자 데이터 스크립트가 필요하기에 꽤 복잡합니다
또한 대역폭이 더 작습니다. 

*다만 이것은 사라질 서비스이고 시험에는 NAT 인스턴스와
NAT Gateway를 고르는 문제가 나옵니다*

*NAT 인스턴스 자체가 소스 및 목적지가 아니라면
트래픽을 송수신할 수 있어야 해요 아주 중요한 부분입니다*

# nat gateway

aws 의 관리형 nat 인스턴스이며 높은 대역폭을 가지고 있습니다. 

가용성이 높으며 관리할 필요가 없습니다. 대역폭에 따라 청구합니다. 

특정 az에서 생성되고 탄력적 ip를 이어 받습니다. 
EC2 인스턴스와 같은 서브넷에서 사용할 수 없어서
다른 서브넷에서 액세스할 때만 NAT Gateway가 도움 됩니다

대역폭은 초당 5GB이며
자동으로 초당 45GB까지 확장할 수 있습니다
그리고 보안 그룹을 관리할 필요가 없습니다

NAT Gateway의 고가용성에 대해 살펴보면
NAT Gateway은 단일 AZ에서 복원 가능하고
단일 AZ 내에서만 중복되지만
AZ가 중지될 경우를 위해 다중 NAT Gateway를
여러 AZ에 두면 결함 허용을 할 수 있지요

라우팅 테이블을 통해 AZ를 서로 연결할 필요는 없습니다

*NAT Gateway는 특정 AZ에서 가용성이 높습니다
그리고 AZ 전체에서 고가용성을 필요로 하는 경우
다른 AZ에 더 만들어야 합니다 반면 NAT 인스턴스는
인스턴스간 장애 조치 스크립트를 통해서
전체적인 관리를 해야 합니다*

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/2ffde27d-1115-4d4f-8cdc-300423304275)

마지막으로, 특정 가용 영역에 하나의 NAT Gateway를 만들었는데
다른 가용 영역에 두 번째 NAT Gateway를 만들 수 있고
라우팅 테이블을 수정해서 가용성을 높일 수 있습니다

# 보안그룹 및 네트워크 acl 즉 nacl

보안 그룹의 특징은 상태 유지입니다
NACL은 무상태이고 보안 그룹은 상태 유지예요

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/6c8f61ed-f536-47b1-a8d6-f02ed1ed6ac0)

네트워크 액세스 제어 목록인 NACL은 무엇일까요?
이들은 서브넷을 오가는
트래픽을 제어하는 방화벽과 비슷합니다

*기본 NACL은 시험에서 정말 중요한 부분입니다
그리고 기본 NACL는 연결된 서브넷을 가지고
인바운드와 아웃바운드의
모든 요청을 허용하는 특수성을 가집니다
이것이 IPv4를 지원하는 기본 NACL의 모습인데
모든 것이 나가고 들어올 수 있습니다*

*그런데 시험 문제에서
예를 들어 기본 NACL이
기본적으로 서브넷과 연결된다면
즉 이 NACL이 서브넷과 연결되어 있다고 말하면
모든 것이 드나들도록 허용된다는 뜻입니다*

*이제 중요한 부분인 임시 포트에 대해 살펴봅시다 그러면 임시 포트가 무엇일까요? 여러분의 OS에 따라
즉 운영 체제에 따라 포트 범위가 달라집니다*

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/15586458-1881-4f5f-abd2-5dc3dc3a5246)

*NACL의 또 다른 특징은 다중 NACL 및 서브넷이 있다면
각 NACL 조합이 NACL 내에서 허용되어야 한다는 것입니다
CIDR 사용 시, 서브넷이 고유의 CIDR을 갖기 때문이죠*

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/05787174-a117-4ad4-b49a-65781d8d8b80)

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/41753db9-6050-4e07-9ce2-83c2b8801ebf)

트래픽이 외부에서 시작해서 인바운드로 허용된다면
거기에 대한 반환 트래픽도 허용된다는 의미입니다

# vpc 피어링

다양한 리전과 계정에서 VPC를 생성할 수 있는데
AWS 네트워크를 통해 연결하고 싶을 때 사용하죠

VPC가 모두 같은 네트워크에서 작동하도록 만들기 위해서예요
연결했을 때 CIDR가 겹치면 통신 할 수 없습니다. 

*A와 C의 VPC 피어링 연결을 활성화해야
그 둘이 통신을 할 수 있지요*

*여러분의 계정에서 할 수 있지만 다른 계정 간에도 가능하단 점입니다*

*동일 리전의 계정 간 VPC에서도
보안 그룹을 참조할 수도 있습니다
CIDR이나 IP를 소스로 가질 필요가 없고
보안 그룹을 참조할 수도 있으니 정말 대단한 기능이지요*

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/2bbf4b1b-287c-4c25-ae8c-76580f8cba27)

그리고 여기는 10.0.0.72였습니다 프라이빗 IP 주소가 다르므로
두 가지는 서로 다른 VPC가 맞습니다

*vpc peering 실습 강의 중요*

# vpc endpoints

인터넷을 경유하지 않고
프라이빗 액세스를 원할 수도 있겠죠
이때 VPC 엔드포인트를 사용하면
퍼블릭 인터넷을 거치지 않고도 인스턴스에 액세스할 수 있습니다

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/2115d272-ad2f-4563-ae7d-3e9b0db58d2c)

VPC 엔드포인트는 중복과 수평 확장이 가능하고
인터넷 게이트웨이나 NAT Gateway 없이도
AWS 서비스에 액세스할 수 있게 해주므로
네트워크 인프라를 상당히 간단하게 만들 수 있죠

인터페이스 엔드포인트는 ENI를 프로비저닝하는데
ENI는 VPC의 프라이빗 IP 주소이자
AWS의 엔트리 포인트입니다
ENI가 있으므로 반드시 보안 그룹을 연결해야겠죠
그리고 대부분의 AWS 서비스를 지원하고
청구되는 요금은 시간 단위
또는 처리되는 데이터 GB 단위로 청구됩니다

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/b7efad75-6b35-4388-bcc9-41f5f526b500)


*게이트웨이 엔드포인트는 특이하게도 게이트웨이를 프로비저닝하는데
이때 게이트웨이는 반드시 라우팅 테이블의 대상이 되어야 합니다
IP 주소를 사용하거나
보안 그룹을 사용하지 않고 라우팅 테이블의 대상이 될 뿐이죠*

*게이트웨이 엔드포인트 대상으로는 Amazon S3와 DynamoDB 두 가지가 있고
장점은 요금이 무료이고
라우팅 테이블 액세스일 뿐이므로 자동으로 확장된다는 점입니다
Amazon S3와 DynamoDB에서만 지원된다는 점 기억하시기 바랍니*

게이트웨이 엔드포인트보다 인터페이스 엔드포인트가 권장되는 경우는
온프레미스에서 액세스해야 할 필요가 있을 때뿐입니다

Site-to-Site VPN이나 직접 연결 방법이 있죠
혹은 다른 VPC에 연결할 때도
인터페이스 엔드포인트 유형을 사용하는 편이 좋습니다

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/8b2cb000-7614-4a0a-b127-9c31f6da996f)

# VPC FOLW LOGS

VPC Flow Logs를 사용하면 여러분의 인터페이스로 들어오는 IP 트래픽에서 정보를 포착할 수 있어요

VPC 수준이나 서브넷 수준 또는 탄력적 네트워크 인터페이스 수준에서 포착할 수 있고요

그런 흐름 로그를 Amazon S3, CloudWatch Logs, Kinesis Data Firehose에 전송할 수 있고요

또 ELB, RDS, ElastiCache, Redshift, WorkSpaces, NATGW, Transit Gateway 등
AWS의 관리형 인터페이스에도 전송할 수 있어요

그리고 VPC Flow Logs를 이용해서 사용 패턴을 분석하거나 악의적인 행동이나 포트 스캔 등을
탐지할 수 있어요

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/eb611f5a-87e4-4a20-8c7b-c58880ea3519)

그걸 예를 들어 NACL 수준에서 차단하고 이 트래픽을 없앨 수 있죠
하지만 보시는 것처럼 많은 트래픽이 여기 나오고요, 모두 거부되고 있죠
여러분이 공격을 받고 있거나 많은 트래픽이 거부되는 등의 일이 발생하면 메트릭 필터를 만들어서 실시간 분석을
할 수도 있을 거예요

# site to site vpn

특정 구조가 있는 기업 데이터 센터를
AWS와 비공개로 연결하려면
기업은 고객 게이트웨이를
VPC는 VPN 게이트웨이를 갖춰야 합니다

VPN 연결이라서 암호화돼 있습니다
공용 인터넷을 거치긴 하지만요

이렇듯 VPN은 두 가지가 필요한데 그중 하나가
가상 프라이빗 게이트웨이 즉 VGW입니다
VPN 연결에서 AWS 측에 있는 VPN 집선기(concentrator)예요
VGW는 생성되면 VPC에 연결됩니다

CGW는 고객 게이트웨이인데요
여러분이 갖춰야 할 소프트웨어 혹은 물리적 장치로
VPN 연결에서 데이터 센터 측에 속하죠

*고객 게이트웨이가 있는 기업 데이터 센터와
가상 프라이빗 게이트웨이를 갖춘 VPC가 있습니다
온프레미스 고객 게이트웨이를 어떻게 구축해야 할까요?*

*고객 게이트웨이가 공용이라면
인터넷 라우팅이 가능한 IP 주소가 고객 게이트웨이 장치에 있습니다
그럼 이걸 사용해서 VGW와 CGW를
연결하면 됩니다*

*고객 게이트웨이를 비공개로 남겨 사설 IP를 가질 수도 있습니다
그런 경우 대부분
NAT-T를 활성화하는 NAT 장치 뒤에 있어요
NAT 장치에 공용 IP가 있을 시
이 공용 IP를
CGW에 사용해야 합니다*

*서브넷의 VPC에서 라우트 전파를 활성화해야
Site-to-Site VPN 연결이 실제로 작동한다는 점입니다*

*Site-to-Site VPN 부분에서 이런 문제도 나올 수 있겠죠
온프레미스에서 AWS로 EC2 인스턴스 상태를 진단할 때
보안 그룹 인바운드 ICMP 프로토콜이 활성화됐는지 확인해야 합니다*

AWS VPN CloudHub도 꼭 알아 두세요
VGW를 갖춘 VPC가 있고
고객 네트워크와 데이터 센터마다
고객 게이트웨이가 마련된 상황을 가정해 봅시다

*CloudHub는 여러 VPN 연결을 통해
모든 사이트 간 안전한 소통을 보장합니다*

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/13ad2b38-3377-46e1-8ec7-04b9dfaeb967)

VPN 연결이므로 모든 트래픽이 공용 인터넷을 통합니다
사설 네트워크로는 연결되지 않습니다
공용 인터넷을 통하지만 VPN 연결은 당연히 암호화됩니다

가상 프라이빗 게이트웨이 하나에
Site-to-Site VPN 연결을 여러 개 만들어
동적 라우팅을 활성화하고 라우팅 테이블을 구성하면 됩니다

# 실습

Site-to-Site VPN 연결을 구성하기 위해서는
온프레미스 호스팅이 된 고객 게이트웨이가 필요합니다

온프레미스와 AWS 사이의 Site-to-Site VPN 연결을 생성하는 과정뿐 입니다
즉 고객 게이트웨이와
가상 프라이빗 게이트웨이를 AWS에서 생성하고
둘을 Site-to-Site VPN 연결로 연결하는 방법만 아시면 되죠

# dx (direct connect)

dx 는 원격 네트워크로부터 vpc로의 전용 프리이빗 연결을 제공합니다. 

Direct Connect를 사용할 때는 전용 연결을 생성해야 하고
AWS Direct Connect 로케이션을 사용합니다
또 VPC에는 가상 프라이빗 게이트웨이를 설치해야
온프레미스 데이터 센터와 AWS 간 연결이 가능하죠

대역폭 처리량이 증가할 때
큰 데이터 세트를 처리할 때 속도가 빨라집니다
퍼블릭 인터넷을 거치지 않기 때문이죠
또 프라이빗 연결을 사용하므로 비용도 절약됩니다

따라서 실시간 데이터 피드를 사용하는 애플리케이션에 유용합니다
또 하이브리드 환경을 지원하는데
이는 온프레미스 데이터 센터와 클라우드가 연결되어 있기 때문입니다
그리고 IPv4와 IPv6 둘 다 지원합니다

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/86909d84-eaa5-4d99-9b41-6539ab69eede)

모든 연결이 비공개입니다. 
그 대신 AWS 내 퍼블릭 서비스

가령 Amazon Glacier 또는 Amazon S3에 연결할 수도 있는데
이때는 퍼블릭 가상 인터페이스 즉 퍼블릭 VIF를 설치해야 합니다

가상 프라이빗 게이트웨이로 연결되지 않고
AWS로 직접 연결되는 거예요

만약 다른 리전에 있는 하나 이상의 VPC와 연결하고 싶다면
Direct Connect Gateway를 써야 합니다

예를 들어 일주일 안에 빠르게 데이터를 전송하고 싶다면
Direct Connect는 답이 될 수 없겠죠
설치 기간이 보통 한 달 이상 걸리니까요

Direct Connect에는 암호화 기능이 없어서
데이터가 암호화되지 않지만
프라이빗 연결이므로 보안을 유지할 수 있습니다

하지만 암호화 과정을 보자면 Direct Connect 로케이션을 가져와
해당 연결에 VPN 연결을 구축하면
Direct Connect에 암호화가 구성됩니다

*핵심 워크로드의 복원력을 높이기 위해서는
여러 Direct Connect를 설치하는 것이 좋습니다*

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/79ff6fa4-1fdf-4fc8-a9c8-a1b459a15c8f)

어쨌든 그러려면 각 Direct Connect 로케이션에
독립적인 연결을 두 개씩 수립하면
복원력을 최대로 만들 수 있습니다

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/c0ab533a-8acd-4fc2-b029-52edddd2df74)

하나 이상의 로케이션에서 각기 다른 장치에 도달하도록 구성하면 됩니다
Site to Site VPN을 통해 퍼블릭 인터넷에 연결할 수 있으므로
안정성이 높아집니다
퍼블릭 인터넷에 언제나 연결되어 있을 테니까요

# transit gateway

네트워크 토폴로지는 정말 복잡해질 수 있습니다
AWS는 이런 문제를 해결하고자
Transit Gateway를 만들었죠

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/14040354-8377-44d6-bce7-2d112f4a8cc3)

Direct Connect Gateway를 Transit Gateway에 연결하면
Direct Connect 연결이
각기 다른 VPC에 직접 연결됩니다

VPN 연결과 함께 작동하고 AWS에서 유일하게
IP 멀티캐스트를 지원하는 서비스로 만약 시험에
IP 멀티캐스트가 나오면 Transit Gateway를 사용해야 합니다

다른 Transit Gateway 사용 사례는
Site-to-Site VPN 연결 대역폭을 ECMP를 사용해 늘리는 경우인데요

등가 다중 경로 라우팅을 뜻하는 ECMP는
여러 최적 경로를 통해 패킷을 전달하는
라우팅 전략이라고 할 수 있습니다

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/7035cd6d-7317-46e2-a7ae-227063655a0c)

기업 데이터 센터를 직접
VPC에 연결한 경우에는 사용할 수 없는 기능이에요

Site-to-Site VPN 하나가 여러 VPC에 생성돼요
동일한 Transit Gateway에
모두 전이적으로 연결되기 때문입니다
ECMP를 사용하면 처리량이 두세 배가 되죠

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/4f597961-8622-46c9-8482-7c2b04b59cd3)


Direct Connect 연결을 여러 계정에서 공유할 때도
역시 Transit Gateway를 사용해요

Direct Connect 로케이션에 연결한
Direct Connect Gateway를 Transit Gateway에 연결하면
여러 계정과 VPC 사이에
Direct Connect 연결을 공유할 수 있게 됩니다

# vpc 트래픽 미러링

vpc 에서 네트워크 트래픽을 수집하고 검사하되 방해되지 않는 방식으로 실행하는 기능입니다. 

따라서 트래픽을 수집해
수집하려는 트래픽이 있는 소스 ENI를 정의할 겁니다
또한 어디로 트래픽을 보낼지 대상을 정의합니다
또한 소스 하나가 아니라 여러 개에 적용되는데요

두 번째 EC2 인스턴스에 또 다른 ENI가 있다면
네트워크 로드 밸런서로 트래픽을 미러링할 수 있습니다
어떻게 작동하는 걸까요? 동일한 VPC에
소스와 대상이 있어야 합니다 다른 VPC에 걸쳐 있기도 하죠

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/f9fbd0ec-e66e-42be-a405-cc041bc74648)

# ipv6

IPv6는 말이죠 놀라지 마세요
3.4x10의 38승 개 고유 IP 주소를 제공합니다

모든 IPv6 주소는 공용이고 인터넷 라우팅이 가능합니다

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/6f98141f-07e4-4ad6-9867-9f7345beb0d4)

VPC에서 IPv6 지원을 활성화할 수 있기 때문입니다
VPC와 서브넷에서 IPv4 비활성은 불가능하지만
IPv6를 활성화할 수 있습니다 공용 IP 주소이며
듀얼 스택 모드로 작동합니다

*서브넷에서 EC2 인스턴스를 실행할 수 없다고 하면
인스턴스가 IPv6를 받지 못해서는 아닙니다
실제로는 공간이 아주 크고
EC2 인스턴스를 위한 IPv6도 충분할 테니까요
진짜 원인은 서브넷에 이용 가능한 IPv4가 없기 때문입니다
솔루션은 서브넷에 IPv4 CIDR를 생성하는 겁니다*

# 송신 전용 인터넷 게이트웨이

IPv6 트래픽에만 사용되며
NAT Gateway와 비슷하지만 IPv6 전용입니다

VPC 인스턴스에서 IPv6상
아웃바운드 연결을 허용하고 동시에 인터넷이
인스턴스로 IPv6 연결을 시작하지 못하게 막습니다

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/5fe7f568-1b1b-4110-bc05-074342d86b4c)

# gb 당 네트워크 비용

EC2 인스턴스로 향하는 트래픽은
무료라는 점을 우선 기억해 두세요
또 다른 EC2 인스턴스가

같은 가용 영역에 위치한다면
가용 영역은 지리적으로 인접한
여러 데이터 센터의 집합이 되므로
두 EC2 인스턴스 간 트래픽은
사설 IP로 통신할 시
전부 무료일 겁니다

인스턴스가 소통할 때 속도는 높이고 비용은 줄이려면
최대한 공용 IP보다는
사설 IP를 사용해야 한다는 점입니다

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/95568827-b7a1-4e8a-ae08-29f003f1fe55)

밖으로 데이터를 내보낼 땐 비용이 드니까
인터넷 트래픽을 최대한 AWS 내부에 두고
비용을 최소화해야겠죠

현명한 방법은
EC2 인스턴스의 AWS Cloud로 애플리케이션을 이동하는 겁니다

Amazon CloudFront로 들어오면 일곱 배나 저렴하답니다
사용 사례에 적합하다면 Amazon S3상에서
CloudFront를 사용해 비용을 절약할 수 있겠죠

그러니까 NAT Gateway보다
VPC 엔드 포인트를 쓰는 게 훨씬 저렴합니다

# 네트워크 보호 방법

그렇다면 전체 VPC를 보호할 수 있는 수준 높은 방법은 없을까요?
그럴 때는 AWS Network Firewall을 사용하면 됩니다

이 방화벽은 VPC 수준에서 설정할 수 있다는 점 기억하시고
트래픽 필터링과 플로우 검사를 지원한다는 점도 기억해 두세요

# quiz

Question 2:
기업 네트워크의 크기는 10.0.0.0/8이고, 위성 사무실의 크기가 192.168.0.0/16입니다. 추후 두 네트워크를 연결할 계획이라면, AWS VPC에 적합한 CIDR은 다음 중 무엇인가요?

Answer : 172.16.0.0/16

Question 17:
(참/거짓) Direct Connect 연결을 사용해, 공용 및 프라이빗 AWS 리소스 모두에 액세스할 수 있습니다.

Answer : 참

한 웹 애플리케이션의 백엔드는 퍼블릭 서브넷의 애플리케이션 로드 밸런서 뒤에 있는 프라이빗 서브넷의 EC2 인스턴스에서 호스팅되고 있습니다. 백엔드 EC2 인스턴스를 인터넷에 노출하지 않고 일부 개발자에게 백엔드 EC2 인스턴스에 대한 액세스 권한을 부여해야 합니다. 퍼블릭 서브넷에 배스천 호스트(Bastion Host) EC2 인스턴스를 생성하고 백엔드 EC2 인스턴스 보안 그룹이 배스천 호스트로부터 트래픽을 받을 수 있도록 설정했습니다. 다음 중 배스천 호스트 보안 그룹의 보안 설정으로 가장 적절한 것은 무엇입니까?

Answer  : 회사의 퍼플릭 cidr 에서 22 번 포트로 들어오는 트래픽만 허용한다. 

Question 10:
VPC에 새로운 서브넷을 생성할 때마다, AWS는 5개의 IP 주소를 예약합니다. CIDR 10.0.0.0/24로 서브넷을 생성할 경우, 다음 중 ....................를 제외한 IP 주소들이 예약됩니다

Answer : 10.0.0.4
