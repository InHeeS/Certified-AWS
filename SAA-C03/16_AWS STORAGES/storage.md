# Aws snow family

아주 안전한 휴대 기기 활용 사례로는 활용해서 엣지에서 데이터를 수집하고 처리하거나 데이터를 aws 안팎으로 마이그레이션하는 것입니다. 

두번째 사용사례는 snowcone, snowball edge 가 있습니다. 

snow family를 이용해서 데이터 마이그레이션을 해야하는 이유는 다음과 같습니다. 
aws에서 데이터를 빠르게 전송하고 싶을대 사용하는 이유가 됩니다. snow family는 여러분이 데이터 마이그레이션을 할 수 있게 해주는 오프라인 기기입니다. 

클라이언트는 snowball 기기를 요청합니다. 네트워크가 아닌 물리적 경로를 사용합니다. 
snowball edge기기를 받게 되며 테라바이트나 페타바이트의 용량의 데이터를 aws와 교환하기 위해 사용됩니다. 
블록 스토리지나 s3 호완 객체 스토리지를 제공합니다. snowball edge에는 두가지의 형태가 있습니다. 

하나는 스토리지가 최적화된 형태고 이걸 쓰게 되면 80tb의 하드 디스크 용량이 제공되고 블록 볼륨이나 s3 호환 객체 스토리지로 사용됩니다. 

그리고 컴퓨팅이 최적화된 형태가 있습니다. 용량은 42, 28 tb입니다. 

정리하자면 활용 사례에는 대규모 데이터의 클라우드 마이그레이션, 데이터센터 폐지, 또는 재난 복구를 위해 데이터를 aws에 백업하는 경우가 있습니다. 

다음으로는 snowcone 은 아주 작은 휴대 기기입니다. 견고하고 안전하며 열확한 환경에 견딜 수 있습니다. 원한다면 드론에도 탑재 가능합니다. 공간 제약이 있는 환경에 사용가능합니다.

즉 오프라인 외에도 인터넷 연결이 가능할 때 그걸 데이터 센터에 연결하는 방법이 있습니다. 
aws datasync 서비스를 이용해서 데이터를 다시 aws 에 전송합니다. 

snowmobile 은 실제 트럭입니다. 1 엑사바이트 1000 페타바이트 1백만 테라바이트 입니다. 

두번째 활용사례로서 엣지 컴퓨팅입니다. 엣지 컴퓨팅은 엣지 위치에서 데이터를 생성하는 중에 그 데이터를 처리하는 걸 말합니다. 

엣지 위치는 인터넷이 없거나 클라우드에서 멀리 떨어저 있는 모든걸 가리킵니다. 연결이 제한되거나 인터넷에 접속할 수 없거나 컴퓨팅 능력에 액세스할 수 없는 경우가 될 수 있죠 활용 사례로는 데이터 전처리, 클라우드로 가지않고 엣지에서 이루어지는 머신러닝 미디어 스트림의 사전 트랜스코딩 등이 있습니다. 

엣지 컴퓨팅용으로는 snowcone, snowcone ssd 가 있습니다. snowcone 기기들은 ec2 인스턴스와 람다 함수를 실행 가능합니다. 람다 함수를 위한 aws iot greengrass 서비스를 활용합니다. opshub 을 사용해서 그래픽 인터페이스를 사용해서 snow 기기에 연결하고 설정하고 사용 가능합니다. 

*데이터를 s3 로 보내거나 s3에서 가져오기 위해 가장 널리 사용된다는점이고요, 원격 컴퓨팅 능력을 제공합니다.*

시나리오
*snowball 을 통해 데이터를 직접 glacier  에 불러올 수 있을까요 그럴수는 없고 먼저 s3사용해서 수명 주기정책을 생성하여 glacier 객체를 전환할 수 있습니다.*

*snowball 이 데이터를 s3로 가져오면 s3의 수명주기 정책을 통해 해당 데이터가 glacier로 전환됩니다.*

# amazon fsx

fsx 는 aws 에서 완전 관리형 서비스로 타사 고성능 파일 시스템을 실행시킵니다. 
fsx 에는 lustre, windows file sever, netapp ontap, openzfs 될 수도 ㅣㅇㅆ겟습니다. 

*중요 4가지*
1. fsx for windows file server 부터 살펴봅니다. 
완전 관리형 windows 파일 서버 공유 드라이브로 windows를 사용하기 때문에 smb 프로토콜과 window ntfs 를 지원합니다.

또한 microsoft active directory 통합을 지원하므로 사용자 보안을 추가하며 acl로 사용자 할당량을 추가햐해 액세스를 제어할 수 있습니다. 

특징으로는 LINUX EC2 인스턴스에도 마운트할 수있단걸 기억해야합니다.

성능 면에서는 수백 수십 GB에 수백만 IOPS 그리고 수백 PB의 데이터까지 확장되며 

스토리지 옵션ㅇ로는 SSD로 지연시간이 짧아야 하는 워크로드를 저장가능합니다. 데이터베이스, 미디어 처리 데이터 분석등이 들어갑니다. 

또한 프라이빗 연결로 온프레이미스 인프라에서 액세스 가능합니다.

또한 재해 복구 목적으로 S3에 매일 백업됩니다.

2.FSK FOR LUSTRE 

Lustre 는 원래 분산 파일 시스템으로 대형  연산에 쓰입니다. 머신러닝과 hpc, 고성능 연산에 쓰였죠 ㅇ동영상 처리나 금융 모델링 전자 설계 자동화 등의 애플리케이션에서 쓰이고 확장성이 상당히 높습니다. 짧은 지연시간을 자랑하죠 

스토리지 옵션은 s3와 무결절성 통합이 가능하며 fsx로 s3를 파일 시스템을 ㅗ읽어들일 수 있습니다. 그리고 fsx의 연산 출력값을 다시 s3에 쓸 수있죠 

vpn과 직접 연결을 통해 온프레미시 서버에서 사용합니다. 
배포 옵션으로는 스크래치 파일 시스템과 영구 파일 ㅣㅅ스템이 있습니다. 

스크래치 파일 시스템은 임시 스토리지로 데이터가 복제되지 안ㄶ습니다. 
영구 파일 시스템은 장기 스토리지로 동일한 가용 영역에 데이터가 복제됩니다. 스크래치 파일 시스템과는 다르게 기저 서버가 오작동하면 몇분 내에 해당 파일이 대체됩니다. 

lustre 는 단일 az에만 있습니다. 

3. fsx for netapp ontap

관리형netapp ontap 파일 시스템으로 nfs, smb, iscsl 프로토콜과 호환 가능합니다. 
다양한 운영 체제에서 사용 가능합니다. 그리고 스토리지는 자동으로 확장 및 축소됩니다. 복제와 스냅샷 기능도 지원합니다. 비용도 적게 들고 데이터 압축이나 데이터 중복제거도 가능합니다. 신속히 복제가 가능하고 스테이징 파일 시슽메을 둘 수 있죠 
net app ontap 에서 중복 파일을 찾을 수 있는 거죠 끝으로 아주 유용한 지정 시간 복제 기능ㅇ ㅣ있는데 새 워크로드 등을 테스트할 대 상당히 유용합니다. 

4. fsx for openzfs

관리형 openzfs 파일 시스템으로 여러 버전에서의 nfs 프로토콜과 호환이 가능합니다. 주로 zfs 에서 실행되는 워크로드를 내부적으로 aws로 옮길 대 사용됩니다. 성능이 상당히 좋아서 백만 iops 까지 확장 가능하며 지연 시간은 0.5 밀리초 이하 입니다. 스냅샷과 압축을 지원하고 비용이 적짐나 데이터 중복제거 기능은 없습니다. 마차나가지로 지정 시간 동시 복제 기능이 있어 새 워크로드 테스트 시에 유용합니다. 

# hybrid cloud for storage 

s3 데이터를 온프레미스에 두려면 aws storage gateway가 s3와 여려분의 온프레미스 인프라를 이어주는 가교의 역할을 합니다. 

storage gateway를 이용해서 온프레미스 데이터를 클라우드로 이동시키죠

대부분을 aws에 저장하고 파일 액세스 지연 시간을 줄이기 위해 storage gateway를 온프레미스 캐시로 사용하는 방법이 있습니다. 

1. s3 파일 케이트웨이

  glacier 를 제외하고 원하는 스토리지 클래스를 임의로 사용가능합니다. 애플리케이션 서버가   nfs 나 smb프로토콜을 사용하도록 합니다. 프로토콜을 통해 https요청으로 변환 시켜 s3 버    킷 으로 버냅니다. 

하지만 수명주기 정책을 이용하면 glacier 로도 옮길 수 있습니다. 

2. fsx 파일 게이트웨이

   이미 온프레미스 시스템에서 액세스 가능합니다. 자주 액세스하는 데이터의 로컬 캐시를 확보가능합니다. 즉 중요한 파일의 로컬 캐시가 회사 데이터센터에 쌓이고 액세스 시 지연시간을 단축시키빈다. 따라서 그룹 파일 공유나 온프레미스를 연결할 홈 디렉터리로 사용가능합니다.

3. 볼륨 게이트웨이

   볼륨이 ebs 스냅샷으로 저장되어 필요에 따라 온프레미스 볼륨을 복구할 수 있습니다. 캐시 볼륨은 최근 데이터 액세스 시 지연 시간이 낮고 다른 하나는 저장 볼륨으로 전체 데이터 세트가 온프레미스에 있으며 주기적 s3백업이 따릅니다.

4. 테이프 게이트우이
   게이트웨이는 여러분의 회사 데이터 센터에 설치되어 있어야 합니다. 없는경우는 aws의 하드웨어를 사용가능합니다. 가상화가 없는 경우 상당히 유용합니다.
   
*정리* 

온프레미스에서 Storage Gateway VM을 배포하거나 하드웨어 어플라이언스에서 배포할 수 있는데
Storage Gateway 서비스와 AWS 클라우드로 도표처럼 나뉩니다
로컬 캐시를 필요로 하는 파일 게이트웨이의 경우
사용자 그룹 파일 공유 시에
NFS나 SMB 프로토콜을 이용하여 액세스할 수 있습니다
첫 번째 옵션은 직접 S3 파일 게이트웨이에 연결해서
데이터가 Amazon S3에 백업되도록 하는 방법이 있는데
이 경우 Glacier와 Glacier Deep Archive를 제외한 많은 스토리지 티어를 포함합니다
하지만 수명 주기 정책을 생성하여 이를 S3 Glacier를 포함한
모든 Amazon S3 스토리지 클래스에 전송할 수 있습니다

FSx 파일 게이트웨이를 사용하는 경우
Amazon FSx for Windows File Server에 데이터를 전송하는데
이때 데이터는 주기적으로 Amazon S3에 백업됩니다

볼륨 게이트웨이를 사용하는 경우에는
iSCSI 프로토콜을 통해 애플리케이션 서버를 갖고 볼륨을 마운트합니다
이렇게 하면 볼륨 게이트웨이는 Storage Gateway를 통해
Amazon S3에 연결되며 해당 위치에 데이터 볼륨이 저장됩니다
그리고 Amazon S3에서 해당 데이터가
AWS EBS 볼륨으로 변환되어 AWS에 저장되죠

다음으로 테이프 게이트웨이를 이용하면 iSCSI VTL 프로토콜을 통해 백업 애플리케이션에 연결합니다
테이프 게이트웨이는 Amazon S3를 테이프 라이브러리로 사용하죠
그리고 해당 테이프를 Glacier와 Glacier Deep Archive 티어로
이동시켜서 테이프 아카이브를 생성합니다

# aws transfer family

FTP는 암호화되지 않는 반면에 FTPS와 SFTP는 전송 중에 암호화된다는 것만 알아두면 됩니다. 
FTP 프로토콜을 사용해서 S3 혹은 EFS에 업로드 가능합니다. 전송 제품군은 완전 관리형 인프라이며 확장성, 안전성이 높고 가용성 또한 높다는 것이 특징입니다. 

FTP 서비스의 전송에는 IAM 역할이 있어 S3나 EFS 의 파일을 보내거나 읽도록 합니다. 

![image](https://github.com/InHeeS/Certified-AWS/assets/105423951/7ebf33e6-eeb1-46b5-8cde-acf831720d3f)

# AWS DATASYNC

간단하지만 핵심 내용을 알아야합니다. 

데이터를 동기화하며 이를 통해 대용량의 데이터를 한곳에서 다른 곳으로 옮길 수 있습니다. 온프레미스 aws의 다른 클라우드로 데이터를 옮길 수 있는데 옮길 위치인 온프레미스나 연결할 다른 클라우드에 에이전트가 있어야 합니다.

aws의 다른 클라우드로 데이터를 옮길 수 있는데 이때 여러분의 서버를 nfs, smb hdfs 또는 다른 프로토콜에 연결해야 합니다

다른 유형으 마이그레이션도 실행 가능하며 가령 한 aws 서비스에서 다른 aws 서비스로 데이터를 옮길 수도 있습니다. 이경우는 에이전트가 필요없습니다.

데이터는 모든 s3의 glacier 를 포함하여 모든 스토리지 클래스에 동기화 합니다. efs로 네트웤 ㅡ파일 시스템에 저장 가능합니다. fsx는 여기 모든 운영 체제에서 사용 가능합니다. 복제 작업은 일정을 지정하여 실행됩니다.

지연이 발생하지만 동기화가 가능하며 

*data sync 에는 파일 권한과 메타데이터 저장 기능이 있습니다. 이는 보안과 관련되어 nfs posix 파일 시스템 그리고 smb 권한을 준수합니다. 이 부분은 파일을 한 곳에서 다른 곳으로 옮길 때 이를 이용하여 파일의 메타데이터를 보존 가능합니다.*

*dataSync를 이용하고자 하지만 네트워크 용량이 따라 주지 못하는 경우 snowcone 장치를 사용합니다. snowcone 장치에는 datasync에이전트가 사전에 설치되어 있습니다.* 

*온프레미스에서 snowcone을 실행하고 데이터를 가져온 다음 datasync 에이전트를 실행하면 다시 에이전트가 aws 리전으로 전송되면서 aws의 스토리지 리소스 외부에 데이터를 동기화 합니다.*

**Amazon S3, Amazon EFS 또는 Amazon FSx를
Amazon S3, Amazon EFS Amazon FSx로 다시 동기화하려는 경우
AWS DataSync 서비스를 사용하여
데이터 복사본을 만듭니다 서로 다른 AWS 스토리지 서비스 간
메타데이터 또한 유지되는데
이 역시 시험에서 나올 수 있는 상당히 중요한 내용입니다**

**다시 말씀드리지만 DataSync로 거의 대부분의 데이터를
동기화할 수 있으나 지속적이지는 않고 일정에 따라 움직입니다
매 시간, 매일, 혹은 매주 진행할 수 있죠
또한 메타데이터와 파일 권한은 보존됩니다
끝으로 NFS 또는 SMB 서버에 연결하려면 DataSync 에이전트를 실행해야 합니다**

*182-모든 aws 스토리지 옵션 비교*

# quiz

Question 1:
수백 TB의 데이터를 Amazon S3로 이전한 후, EC2 인스턴스 플릿을 사용해 처리해야 합니다. 광대역은 1Gbit/초입니다. 여러분은 데이터를 더 빠르게 이전하고, 가능하면 전송 중에 데이터를 처리했으면 합니다. 어떤 방법을 추천할 수 있을까요?

answer : snowball edge 사용

Question 7:
고성능 컴퓨팅(HPC)과 전산 유전학 연구를 수행하기 위해 IOPS를 최대화해 줄 분산 POSIX 준수 파일 시스템이 필요한 상황입니다. 이 파일 시스템은 수백만 개의 IOPS로 손쉽게 스케일링할 수 있어야 합니다. 어떤 방법을 추천할 수 있을까요?

answer : lustre 용 fsxlustre 용 amazon fsx

Question 12:
S3 버킷에 있는 다량의 데이터를 EFS 파일 시스템으로 옮기는 데 가장 적합한 AWS 서비스는 무엇입니까?

answer : aws datasync
